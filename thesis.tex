
\documentclass[12pt,a4paper,onecolumn,oneside]{memoir}
%twoside for print version
\input{0-preamble/packages.tex}
\input{0-preamble/hoepelman-pagestyle.tex}
\input{0-preamble/commands.tex}
\input{0-preamble/font.tex}

\maxsecnumdepth{subsection} % chapters, sections, and subsections are numbered
\maxtocdepth{subsection} % chapters, sections, and subsections are in the Table of Contents

\newcommand{\todo}[1]{\textbf{TODO: #1}}
\newcommand{\ignore}[1]{}
\newcommand{\f}[1]{\texttt{#1}}
\newcommand{\key}[1]{\textbf{#1}}

\begin{document}

\include{0-title/title}

\cleardoublepage

%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%
\tableofcontents*

\clearpage
%\twocolumn

%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%
%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%

\chapter{Introduction}

Like all people, I sometimes get asked what I do for a living.
When I tell someone I am writing my master thesis in Computer Science, their eyes start to glaze over as they anticipate some explanation peppered with terms they will not understand about 
I then tell them my thesis is about spreadsheets and ask if they have ever worked with Excel, and nearly everyone who has ever worked in business or research has.
Nearly everyone has a horror story about that one unmaintainable spreadsheet that they had to work on, or that day their reporting system broke down because 2009 turned into 2010 and the spreadsheet only looked at the last digit.

This anecdotal evidence is mirrored in research.
Panko \cite{panko2006facing} estimates that 80\% to 95\% of businesses use spreadsheets in one of their processes.
Furthermore, almost all spreadsheets contains at least one error and 1 to 5\% of spreadsheet cells contains an error according to Panko \cite{panko1998we}.
Spreadsheets perform roles very similar to software in that they perform business-critical roles, are inherited throughout the organization and maintained by different users and accrue technical dept during and after the initial development period \cite{panko1998we}.
In short, spreadsheets can be classified as programs, and spreadsheet creators are end-user programmers.

%\chapter{Spreadsheet anatomy}
\include{anatomy/chapter}

\chapter{Previous and related work}

\section{Refactoring}

\section{The BumbleBee spreadsheet refactoring suite}

\section{Other spreadsheet refactoring efforts}


\chapter{Candidate spreadsheet refactorings}

\section{Comparing spreadsheets to other programming paradigms}

\subsection{Reactive programming}
As explained in chapter \ref{chapter:anatomy}, the spreadsheet programming model is a variation of the dataflow programming model.
Thus the most natural first comparison for spreadsheet is the \emph{reactive programming} paradigm, which is another variation of the dataflow programming model.
Viewed from the RP model, all spreadsheet cells are observable values and every formula is an observer.
One can attach a formula observer to a cell observable by making a reference, e.g. a formula \f{=A1+1} in cell B1 listens to the value of A1 and produces the value for B1.
However currently no literature on refactoring reactive programs is known to the author, so no additional refactoring were found by comparing spreadsheets to reactive programs.

\subsection{Functional programming}
Spreadsheets program do not contain state (mutable variables) or side-effects
\footnote{As long as one remains within the spreadsheet model. User-defined functions and inter-operation with external programs can cause side-effects.}
and this immutability aspect is often associated with functional programming languages.
However spreadsheets lack several other important concepts of functional languages such as first-class and higher-order functions, recursion\footnote{Most spreadsheet implementations allow for a form of recursion in the form of cycles in the dependency graph called circular references. However this is not the normal modus-operandi, triggers a warning and is generally only used to perform iterative calculations which are not otherwise possible in spreadsheets.}, lazy evaluation and type interference.

\subsection{Translation of concepts}

Some literature exist on refactoring functional programs, most prominent is the tool \textbf{Ha}skell \textbf{Re}factoring tool (HaRe) \cite{thompson2005refactoring}.
Most of the described refactorings are either specific to Haskell, or only applicable because of concepts not available in spreadsheets.

This makes all of the current literature on refactoring functional programs not applicable.
\todo{Cite functional refactoring literature}

\subsection{Object-oriented programming}

By far 



\section{Translating refactorings to the spreadsheet domain}

Tabel met mogelijke refactorings.
Subsecties voor alle geÃ¯mplementeerde refactorings.

%\chapter{Parsing spreadsheet formulas}
\include{parsing/chapter}

\chapter{Implementing refactorings}

Parse -> Transform -> Print

\section{Transforming formula ASTs}

\section{Refactoring-specific implementation}

\subsection{Extract formula}

\subsection{Inline formula}

\subsection{Addition to SUMIF}

\subsection{\textasciicircum\textasciicircum or Aggregate to conditional Aggregate}

\subsection{Group References}

\chapter{Evaluation}


\chapter{Conclusion}

\section{Future Work}

\bibliographystyle{unsrt}
\bibliography{thesis}

\end{document}

