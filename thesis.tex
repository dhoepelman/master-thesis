% !TeX encoding = UTF-8
% !TeX program = xelatex
% !TeX spellcheck = en_US

\documentclass[12pt,a4paper,onecolumn,oneside,parskip]{memoir}
%twoside for print version
\input{0-preamble/packages.tex}
\input{0-preamble/hoepelman-pagestyle.tex}
\input{0-preamble/commands.tex}
\input{0-preamble/font.tex}

\maxsecnumdepth{subsection} % Chapters, sections, and subsections are numbered
\maxtocdepth{subsection} % Chapters, sections, and subsections are in the Table of Contents

\newcommand{\todo}[1]{\textbf{TODO: #1}}
\newcommand{\ignore}[1]{}
\newcommand{\f}[1]{\texttt{#1}}
\newcommand{\key}[1]{\textbf{#1}}
\newcommand{\rf}[1]{\textsc{\lowercase{#1}}}
\newcommand{\fw}{\textbf{\{Note in Future work\}}}
\newcommand{\noparskip}[1]{{\parskip=0pt
#1
}}
\newcommand{\rom}[1]{\uppercase\expandafter{\romannumeral #1\relax}}

\nonzeroparskip

\begin{document}

\include{0-title/title}

\cleardoublepage

%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%
\tableofcontents*

\clearpage
%\twocolumn

%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%
%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%---%%%


\include{intro/intro}

\include{related/related}

%\chapter{Spreadsheet anatomy}
\include{anatomy/anatomy}


%\chapter{Candidate spreadsheet refactorings}
%\label{chapter:candidaterefactorings}
%
%\section{Comparing spreadsheets to other programming paradigms}
%
%\subsection{Reactive programming}
%As explained in Chapter \ref{chapter:anatomy}, the spreadsheet programming model is a variation of the dataflow programming model.
%Thus the most natural first comparison for spreadsheet is the \emph{reactive programming} paradigm, which is another variation of the dataflow programming model.
%Viewed from the RP model, all spreadsheet cells are observable values and every formula is an observer.
%One can attach a formula observer to a cell observable by making a reference, e.g. a formula \f{=A1+1} in cell B1 listens to the value of A1 and produces the value for B1.
%However currently no literature on refactoring reactive programs is known to the author, so no additional refactoring were found by comparing spreadsheets to reactive programs.
%
%\subsection{Functional programming}
%Spreadsheets program do not contain state (mutable variables) or side-effects
%\footnote{As long as one remains within the spreadsheet model. User-defined functions and inter-operation with external programs can cause side-effects.}
%and this immutability aspect is often associated with functional programming languages.
%However spreadsheets lack several other important concepts of functional languages such as first-class and higher-order functions, recursion\footnote{Most spreadsheet implementations allow for a form of recursion in the form of cycles in the dependency graph called circular references. However this is not the normal modus-operandi, triggers a warning and is generally only used to perform iterative calculations which are not otherwise possible in spreadsheets.}, lazy evaluation and type interference.
%
%\subsection{Translation of concepts}
%
%Some literature exist on refactoring functional programs, most prominent is the tool \textbf{Ha}skell \textbf{Re}factoring tool (HaRe) \cite{thompson2005refactoring}.
%Most of the described refactorings are either specific to Haskell, or only applicable because of concepts not available in spreadsheets.
%
%This makes all of the current literature on refactoring functional programs not applicable.
%\todo{Cite functional refactoring literature}
%
%\subsection{Object-oriented programming}
%
%By far 
%
%
%
%\section{Translating refactorings to the spreadsheet domain}
%
%Tabel met mogelijke refactorings.
%Subsecties voor alle ge√Ømplementeerde refactorings.

%\chapter{Parsing spreadsheet formulas}
\include{parsing/parsing}

\include{implementation/refactorings}

\chapter{Evaluation}
\label{chapter:evaluation}

\chapter{Conclusion}

\chapter{Future Work}

\chapter{Discussion}
\label{chapter:discussion}

\todo{Bibliography uniform}

\bibliographystyle{unsrt}
\bibliography{thesis}

\appendix

\chapter{Code listings}
\include{appendix/codelistings}

\chapter{A Grammar for Spreadsheet Formulas Evaluated on Two Large Datasets}
\label{appendix:xlparser}

The following is a verbatim copy of the papers as it was published in the proceedings of SCAM 2015.

\clearpage

\includepdf[pages={1-10}]{appendix/scam-xlparser.pdf}

\clearpage

\vspace*{\fill}

\centering
\large{End of appendix \ref{appendix:xlparser}}

\vspace*{\fill}

\end{document}

